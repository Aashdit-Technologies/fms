import{u as v,a as y,b as m,y as t,r as h,j as s,L as w}from"./index-CK-hXRpW.js";import{u as p,e as L,a as j,G as N,T as f,I as x,F as b,M as S,b as M,c as P,d as A}from"./encrypt-CU7CtBKz.js";const C=()=>{const o=v(),u=y(),i=m(e=>e.setToken),d=p({mutationFn:async e=>{var g,l;try{const n={userName:e.userName,password:e.password,captcha:"is"},r=L(n);return(await j.post("/umt/login",{dataObject:r})).data}catch(n){const r=((l=(g=n.response)==null?void 0:g.data)==null?void 0:l.message)||n.message||"Login failed.";throw t.error(r),new Error(r)}},onSuccess:e=>{e!=null&&e.outcome?(i(e.data),u.invalidateQueries(["user"]),t.success(e.message||"Login successful!"),o("/")):t.error(e.message||"Login failed.")},onError:e=>{t.error(e.message||"Login failed.")}}),c=p({mutationFn:async()=>{try{const e=m.getState().token;await j.post("/umt/logout",{},{headers:{Authorization:`Bearer ${e}`}}),m.getState().clearAuth(),u.clear(),o("/login")}catch(e){throw t.error("Logout error:",e),e}},onSuccess:()=>{t.success("Logout successful!")},onError:e=>{t.error(e.message||"Logout failed.")}});return{login:d.mutate,logout:c.mutate,isLoggingIn:d.isLoading,isLoggingOut:c.isLoading}},I="/assets/od-logo-B584uO4O.png";function k(o){return N({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M218.1 167.2c0 13 0 25.6 4.1 37.4-43.1 50.6-167.5 194.5-167.5 194.5l2.9 36.3s34.8 33 40 28c15.4-15 24.8-25.2 24.8-25.2l7.24-43.35 47.11-3.47 3.78-46.8 49.63-.95.49-50.09 52.69 2.1 9-18.84c15.5 6.7 29.6 9.4 47.7 9.4 68.5 0 124-53.4 124-119.2S408.5 48 340 48s-121.9 53.4-121.9 119.2zM406.85 144A38.85 38.85 0 1 1 368 105.15 38.81 38.81 0 0 1 406.85 144z"},child:[]}]})(o)}const F=()=>{const[o,u]=h.useState(""),[i,d]=h.useState(""),[c,e]=h.useState(!1),{login:g,isLoggingIn:l}=C(),n=async a=>{if(a.preventDefault(),!o||!i){t.error("Both username and password are required.",{autoClose:1e3});return}try{await g({userName:o,password:i})}catch{t.error("Login failed. Please try again.",{autoClose:1e3})}},r=()=>{e(a=>!a)};return s.jsxs("div",{className:"login_main",children:[s.jsx("div",{className:"container",children:s.jsx("div",{className:"log-logo-sec",children:s.jsx(w,{to:"/",children:s.jsx("img",{src:I,alt:""})})})}),s.jsx("div",{className:"container-fluid",children:s.jsx("div",{className:"container cntr_cls",children:s.jsxs("div",{className:"box",children:[s.jsx("div",{className:"shadow"}),s.jsx("div",{className:"content",children:s.jsxs("div",{className:"form",children:[s.jsx("h3",{className:"logos",children:s.jsx(k,{})}),s.jsx("h2",{children:"Log in"}),s.jsxs("form",{onSubmit:n,children:[s.jsx("div",{className:"inputBox",children:s.jsx(f,{label:"Email",variant:"outlined",fullWidth:!0,value:o,onChange:a=>u(a.target.value),autoComplete:"off",InputProps:{startAdornment:s.jsx(x,{position:"start",children:s.jsx(b,{})})},margin:"normal"})}),s.jsx("div",{className:"inputBox",children:s.jsx(f,{label:"Password",variant:"outlined",fullWidth:!0,type:c?"text":"password",value:i,onChange:a=>d(a.target.value),autoComplete:"off",margin:"normal",InputProps:{startAdornment:s.jsx(x,{position:"start",children:s.jsx(S,{})}),endAdornment:s.jsx(x,{position:"end",children:s.jsx(M,{onClick:r,edge:"end",children:c?s.jsx(P,{}):s.jsx(A,{})})})}})}),s.jsx("div",{className:"inputBox d-flex justify-content-center",children:s.jsx("button",{type:"submit",className:"btn btn-primary btn-block mt-3 text-center",disabled:l,children:"Login"})})]})]})})]})})})]})};export{F as default};
