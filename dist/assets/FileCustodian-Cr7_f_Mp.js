import{r as s,j as t,P,b as h,y as v}from"./index-CU8vfzW6.js";import{e as $,f as x,X}from"./Admin-BtntgcuL.js";import{T as u,B as Y,e as b,a as C}from"./cggovt-W4HAS40Q.js";const K=()=>{const{fetchAllData:I,office:f}=$(),[p,F]=s.useState(""),[g,w]=s.useState(""),[l,D]=s.useState(""),[S,L]=s.useState(""),[O,r]=s.useState(!1),[k,y]=s.useState([]),[N,j]=s.useState([]),[A,c]=s.useState([]),[m,T]=s.useState([]),[d,z]=s.useState(""),E={table:{style:{border:"1px solid #ddd",borderRadius:"10px",backgroundColor:"#ffffff",marginBottom:"1rem"}},tableWrapper:{style:{display:"block",maxHeight:"450px",overflowY:"auto",boxShadow:"0px 3px 6px rgba(0, 0, 0, 0.1)"}},headRow:{style:{backgroundColor:"#005f73",color:"#ffffff",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",minHeight:"52px",borderBottom:"2px solid #003d4c"}},headCells:{style:{padding:"16px",textAlign:"center",fontWeight:"bold",borderRight:"1px solid rgba(255, 255, 255, 0.1)"}},rows:{style:{fontSize:"14px",fontWeight:"400",color:"#333",backgroundColor:"#ffffff",minHeight:"50px",transition:"background-color 0.2s ease-in-out","&:not(:last-of-type)":{borderBottom:"1px solid #ddd"},"&:hover":{backgroundColor:"#e6f2f5",cursor:"pointer"}},stripedStyle:{backgroundColor:"#f9f9f9"}},cells:{style:{padding:"12px 16px",textAlign:"center",borderRight:"1px solid #ddd"}},pagination:{style:{borderTop:"1px solid #ddd",padding:"10px",backgroundColor:"#f9f9f9"}},noData:{style:{padding:"24px",textAlign:"center",fontSize:"14px",color:"#777",backgroundColor:"#f9f9f9"}}};s.useEffect(()=>{I()},[]),s.useEffect(()=>{(async()=>{if(!l){c([]);return}r(!0);const a={fromCustodianId:l};try{const o=h.getState().token,i=b(a),n=await C.get("file/file-custodian",{headers:{Authorization:`Bearer ${o}`},params:{dataObject:i}});c(n.data.data||[]),console.log(c)}catch(o){console.error("Error fetching custodian table data:",o),c([])}finally{r(!1)}})()},[l]),s.useEffect(()=>{(async()=>{if(!p){y([]);return}r(!0);const a={officeId:p};try{const o=h.getState().token,i=b(a),n=await C.get("file/custodian-list-by-office-id",{headers:{Authorization:`Bearer ${o}`},params:{dataObject:i}});y(n.data.data||[])}catch(o){console.error("Error fetching custodian data:",o),y([])}finally{r(!1)}})()},[p]),s.useEffect(()=>{(async()=>{if(!g){j([]);return}r(!0);const a={officeId:g};try{const o=h.getState().token,i=b(a),n=await C.get("file/custodian-list-by-office-id",{headers:{Authorization:`Bearer ${o}`},params:{dataObject:i}});j(n.data.data||[])}catch(o){console.error("Error fetching custodian data:",o),j([])}finally{r(!1)}})()},[g]);const B=e=>{T(a=>a.includes(e)?a.filter(o=>o!==e):[...a,e])},W=async()=>{if(!l||!S||m.length===0){v.warning("Please select both custodians and at least one file.");return}r(!0);const e={toCustodianId:S,fileIds:m};try{const a=h.getState().token,o=b(e);(await C.post("file/assign-file",{},{headers:{Authorization:`Bearer ${a}`},params:{dataObject:o}})).status===200&&(v.success("Files assigned successfully!"),c(n=>n.filter(M=>!m.includes(M.docFileId))),T([]))}catch(a){console.error("Error assigning files:",a),v.error("Failed to assign files.")}finally{r(!1)}},H=A.filter(e=>e.docFileName.toLowerCase().includes(d.toLowerCase())||e.subjectName.toLowerCase().includes(d.toLowerCase())||e.fullName.toLowerCase().includes(d.toLowerCase())||e.status.toLowerCase().includes(d.toLowerCase())),R=[{name:"Select",cell:e=>t.jsx("input",{type:"checkbox",checked:m.includes(e.docFileId),onChange:()=>B(e.docFileId)}),ignoreRowClick:!0,allowOverflow:!0,button:!0},{name:"File Number",selector:e=>e.docFileName,sortable:!0},{name:"Subject",selector:e=>e.subjectName,sortable:!0},{name:"Custodian",selector:e=>e.fullName,sortable:!0},{name:"Status",selector:e=>e.status,sortable:!0}];return t.jsxs(t.Fragment,{children:[O&&t.jsx(P,{}),t.jsx("div",{children:t.jsxs("form",{className:"row",children:[t.jsx("div",{className:"form-group col-md-4",children:t.jsx(x,{id:"officeFromSelect",options:f,getOptionLabel:e=>e.officeOrgName,value:f.find(e=>e.officeOrgId===p)||null,onChange:(e,a)=>F(a?a.officeOrgId:""),size:"small",renderInput:e=>t.jsx(u,{...e,label:"Select Office",variant:"outlined",fullWidth:!0})})}),t.jsx("div",{className:"form-group col-md-8",children:t.jsx(x,{id:"custodianFromSelect",options:k,getOptionLabel:e=>e.custodianName,value:k.find(e=>e.custodianId===l)||null,size:"small",onChange:(e,a)=>D(a?a.custodianId:""),renderInput:e=>t.jsx(u,{...e,label:"Select Custodian",variant:"outlined",fullWidth:!0})})}),t.jsx("div",{className:"form-group col-md-9 mt-3 mb-2"}),t.jsx("div",{className:"form-group col-md-3 mt-3 mb-2",children:t.jsx(u,{label:"Search Files",fullWidth:!0,value:d,size:"small",onChange:e=>z(e.target.value),placeholder:"Search by File Number, Subject, Custodian, or Status"})}),t.jsx("div",{className:"col-md-12 ",children:t.jsx(X,{columns:R,data:H,pagination:!0,striped:!0,bordered:!0,noDataComponent:t.jsx("div",{children:"No data available"}),customStyles:E,responsive:!0,fixedHeader:!0,fixedHeaderScrollHeight:"450px",highlightOnHover:!0,pointerOnHover:!0})}),t.jsx("div",{className:"form-group col-md-4",children:t.jsx(x,{id:"officeToSelect",options:f,getOptionLabel:e=>e.officeOrgName,value:f.find(e=>e.officeOrgId===g)||null,onChange:(e,a)=>w(a?a.officeOrgId:""),size:"small",renderInput:e=>t.jsx(u,{...e,label:"Select Office",variant:"outlined",fullWidth:!0})})}),t.jsx("div",{className:"form-group col-md-8",children:t.jsx(x,{id:"custodianToSelect",options:N,getOptionLabel:e=>e.custodianName,value:N.find(e=>e.custodianId===S)||null,size:"small",onChange:(e,a)=>L(a?a.custodianId:""),renderInput:e=>t.jsx(u,{...e,label:"Select Custodian To",variant:"outlined",fullWidth:!0})})}),t.jsx("div",{className:"col-md-12 text-center mt-4",children:t.jsx(Y,{variant:"contained",color:"primary",onClick:W,disabled:O,children:"Assign Files"})})]})})]})};export{K as default};
